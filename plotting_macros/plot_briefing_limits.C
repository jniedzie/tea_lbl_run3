#ifdef __CLING__
#pragma cling optimize(0)
#endif

string color_green = "#d3fa00";
string color_pink = "#fa00d3";
string color_blue = "#00d3fa";

string color_other = color_pink;
string color_atlas = color_blue;
string color_cms = color_green;

float other_alpha = 0.2;
float atlas_alpha = 0.2;
float cms_alpha = 0.2;

string other_plotting_style = "FL";
string atlas_plotting_style = "FL";
string cms_plotting_style = "FL";

float legend_text_size = 0.04;

float cms_line_width = 10;
float atlas_line_width = 7;
float other_line_width = 5;

double x_atlas_2020[65] = {6,  6,  7,  8,  9,  10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,  25, 26,
                           27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46,  47, 48,
                           49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 65, 70, 75, 80, 85, 90, 95, 100, 100};
double y_atlas_2020[65] = {
    0.1,         0.000122467, 0.000116366, 8.49663e-05, 0.000103857, 0.000109311, 7.30146e-05, 5.86715e-05, 5.59941e-05, 5.32237e-05,
    6.09981e-05, 7.49626e-05, 6.21687e-05, 5.86111e-05, 5.93107e-05, 5.65941e-05, 6.1221e-05,  6.36025e-05, 6.66919e-05, 7.76111e-05,
    7.22495e-05, 7.55724e-05, 7.84017e-05, 7.12818e-05, 7.35715e-05, 7.62527e-05, 6.67633e-05, 6.90057e-05, 7.0691e-05,  7.2809e-05,
    7.53627e-05, 7.74836e-05, 8.00609e-05, 8.16409e-05, 8.3848e-05,  8.613e-05,   8.80416e-05, 9.07273e-05, 9.2885e-05,  9.58423e-05,
    9.7718e-05,  0.000100639, 0.000102324, 0.000105275, 0.000107988, 0.00011054,  0.000113751, 0.00011715,  0.000119107, 0.000122068,
    0.000124916, 0.00012778,  0.000131584, 0.000134506, 0.000137329, 0.000141757, 0.000159553, 0.000169982, 0.0001916,   0.000215404,
    0.000242497, 0.000269851, 0.000306183, 0.000340753, 0.1};

double x_cms_expected[12] = {5.0, 5, 6, 9, 11, 14, 16, 22, 30, 90, 100, 100};
double y_x_cms_expected[12] = {0.1,
                               0.00022045009740102094,
                               0.0001187340665689742,
                               9.237880368404565e-05,
                               8.853478113454209e-05,
                               8.433899031346375e-05,
                               7.95565897200477e-05,
                               8.71983666086086e-05,
                               0.00010035182497958016,
                               0.0004264757172996522,
                               0.00049,
                               0.1};

double x_cms_observed[12] = {5.0, 5, 6, 9, 11, 14, 16, 22, 30, 90, 100, 100};
double y_cms_observed[12] = {0.1,
                             0.0002012908409102225,
                             0.00010911348451407545,
                             8.071656484446354e-05,
                             9.358134167078578e-05,
                             8.313446951580944e-05,
                             7.733233465723593e-05,
                             7.825075116812163e-05,
                             9.554360860479035e-05,
                             0.0004264757172996522,
                             0.00049,
                             0.1};
// end of data points

const int nOtherPoints = 251;

double other_x[nOtherPoints] = {
    0.03802637336557258,   0.04246106970672789,   0.047412947411701115,  0.05267753331019764,  0.07010444908608382,  0.07828014180523836,
    0.08740929685537792,   0.09760310853499618,   0.10898573879911193,   0.12169582956806507,  0.13588819140417863,  0.16943134731724327,
    0.18919070140555755,   0.15173568912458738,   0.06091908381970449,   0.20092331980490263,  0.21314591026141225,  0.23853429355100292,
    0.2660559336721101,    0.2970838012064508,    0.3339553385308881,    0.3737336581140732,   0.4177843177366642,   0.46650699153590286,
    0.5209117813011203,    0.5862157699716203,    0.6516702925285018,    0.7245139291111253,   0.8098195774215657,   0.904262028781883,
    0.9491697979099364,    1.0510434970712914,    1.1736178668658366,    1.3143579160458234,   1.463318146808105,    1.633972644127885,
    1.8245291412410725,    2.037308641121504,     2.2749028258134705,    2.5402056234568726,   2.8364484567091512,   3.167239601894511,
    3.536608138279841,     3.949053022785426,     4.387543561575267,     6.017372136955101,    6.719127677579035,    7.502723069152505,
    8.37770260568637,      9.346199455432961,     10.034982362199965,    10.034982362199965,   10.034982362199965,   10.034982362199965,
    10.034982362199965,    10.034982362199965,    10.034982362199965,    10.034982362199965,   10.034982362199965,   10.034982362199965,
    10.657299515343043,    11.900170790837258,    13.314664754756176,    14.83765402690362,    16.568044916191262,   18.43850003868166,
    20.349356004391176,    21.71994764856876,     23.416499397423838,    26.016594503289493,   28.048758651103128,   30.058256572058273,
    31.059211371958703,    34.79750812587427,     37.704126938103514,    40.44590336194191,    43.934334985946506,   45.16276915215466,
    45.44671490645176,     50.076967400446385,    54.45974858229236,     57.0212160493283,     58.322406317942715,   60.58774481463794,
    67.11301291823234,     74.56503268715613,     78.55642230437542,     84.24074080812584,    85.80379853843536,    98.24269554193933,
    103.0355186814796,     107.84565061290554,    120.21163844501196,    121.88065215121321,   135.59919837868003,   145.26095557602486,
    154.37982092034383,    175.09491856824275,    201.22846721309915,    214.78182269390263,   241.03554569785882,   268.8457756079354,
    285.4273055820494,     314.4061680045295,     316.89319718793445,    352.837411123692,     393.9858730369589,    439.93313423977827,
    491.23883836281294,    548.5278955699691,     609.4347233795593,     657.0378558774746,    704.816469231167,     752.8034735933331,
    771.3862273189854,     844.2434841888693,     928.6265599874066,     1031.7383587589065,   1152.0613325179575,   1286.4165634779902,
    1436.4405158652642,    1597.9401510530936,    1692.786917686084,     1881.2202622542418,   2050.65899599803,     2156.1000643464818,
    2324.5136993174074,    2593.237035647547,     2648.1849857613443,    2648.1849857613443,   2674.87450844261,     2674.87450844261,
    2674.87450844261,      2674.87450844261,      2674.87450844261,      2674.87450844261,     2674.87450844261,     2674.87450844261,
    2674.87450844261,      2674.87450844261,      2674.87450844261,      2674.87450844261,     2674.87450844261,     2674.87450844261,
    2674.87450844261,      2674.87450844261,      2674.87450844261,      2674.87450844261,     2674.87450844261,     2674.87450844261,
    2701.833019364797,     2701.833019364797,     2701.833019364797,     2701.833019364797,    2701.833019364797,    2701.833019364797,
    186.76713141062308,    40.72541052723823,     8.218606859349645,     1.911569684865185,    0.40099505171512784,  0.021414970909995886,
    0.004492275346026626,  0.08631746049844916,   0.0011002207226584613, 0.0010861115683523,   0.03978165314990588,  0.041409806249568235,
    0.0431045951550869,    0.04486874708580201,   0.04670510087860279,   0.0486166115561252,   0.05035325058218962,  0.05215192427110515,
    0.053475895986315525,  0.05156688025076839,   0.046432689895268144,  0.049106590225965155, 0.05267753331019764,  0.057077661869616034,
    0.06184533101270981,   0.06667608871921145,   0.07152465419280536,   0.07672579864341048,  0.08230516098127914,  0.08829024453218992,
    0.09423686374668007,   0.10008094145915053,   0.10628743832429136,   0.11287882968358258,  0.11927941748512953,  0.12541254309799732,
    0.13120152800816598,   0.13588819140417863,   0.13794766635156117,   0.14872280072968858,  0.1512293354548873,   0.1523710160311329,
    0.1465275481177209,    0.16033958414717572,   0.16606709107001955,   0.17113894773468197,  0.17113894773468197,  0.18450666324552617,
    0.18824447602034305,   0.1912891730113508,    0.19991841446722716,   0.2140264416895395,   0.21553410292009798,  0.21553410292009798,
    0.23120735595389985,   0.23994709220126115,   0.24802033981142502,   0.24802033981142502,  0.2647252716656942,   0.2660559336721101,
    0.26873735733186466,   0.2783369523584564,    0.28255533200123245,   0.28540304354053436,  0.2997437703950813,   0.3000779367721944,
    0.3015863016778717,    0.3046258153380837,    0.3186872019002081,    0.32189906562916865,  0.3251432998723886,   0.3350735045974946,
    0.3350735045974946,    0.3401517640188569,    0.3470427000238849,    0.3523023604769796,   0.3704170920549111,   0.3769748965880101,
    0.39142091648804156,   0.4156947957672963,    0.4177843177366642,    0.44147401415962273,  0.46185225020419984,  0.46650699153590286,
    0.48804073822326033,   0.4904939126551931,    0.5004305424789778,    0.04828992181461405,  0.01363104488862028,  0.004211525764505682,
    0.0011002207226584613, 0.0010721833488632488, 0.0010861115683523,    0.0010861115683523,   0.0011289912680051298};

double other_y[nOtherPoints] = {
    1.3520847462144618,      1.3939585017209155,      1.3939585017209155,      1.3939585017209155,      1.415216925976315,
    1.415216925976315,       1.415216925976315,       1.415216925976315,       1.405729003974624,       1.3869753668918734,
    1.4064813907409008,      1.3945979802945696,      1.4055141102621123,      1.3469569167060362,      1.4255298357243749,
    1.2164417654816655,      1.0795339924739,         1.0438288103590578,      1.0116217815753696,      0.9787611257838268,
    0.9452321921067803,      0.9139689916931989,      0.9111786783836785,      0.9693793990763057,      1.0130146650839498,
    1.0008534173357135,      0.9891405620540121,      0.9782225894536629,      0.9889137559307246,      1.1449819659287483,
    1.3320800913789599,      1.4006876771506223,      1.4829963505429336,      1.5285119739350488,      1.415216925976315,
    1.415216925976315,       1.415216925976315,       1.415216925976315,       1.415216925976315,       1.415216925976315,
    1.415216925976315,       1.415216925976315,       1.415216925976315,       1.415216925976315,       1.415216925976315,
    1.3939585017209155,      1.3939585017209155,      1.3939585017209155,      1.3939585017209155,      1.4055141102621123,
    1.3730194070280217,      1.162443398508301,       0.9841628223307047,      0.8332246216038214,      0.7054353754215884,
    0.597244795693055,       0.5056470917258211,      0.4280974622375502,      0.362441394745734,       0.28937559562529835,
    0.24085863825886275,     0.258723209321781,       0.24232124648027367,     0.24545884598013692,     0.21724268632885776,
    0.215555439376907,       0.21644084447299117,     0.26415483137156076,     0.2864342936509799,      0.2375672762005438,
    0.22372680838850112,     0.2813262423312679,      0.3035188330628596,      0.30897314731812175,     0.2959084224912433,
    0.36519462555753845,     0.3127154899879992,      0.4379276907004443,      0.372482621366096,       0.31485262621173066,
    0.36750495419273754,     0.43134943935874676,     0.31469382017313435,     0.5400584919712667,      0.4799213606532325,
    0.4237024225540008,      0.47164033126889715,     0.3811960192387931,      0.3427023379415423,      0.28341562829634187,
    0.2323544262363777,      0.2159908775540389,      0.2508578054567939,      0.2969552899559108,      0.20946419762662757,
    0.23545204833174674,     0.21247059072290295,     0.1349856642688669,      0.08124725250574408,     0.06653388009214939,
    0.062324486901095946,    0.053288852778442794,    0.052734854721726544,    0.03750455964563371,     0.043786645600947804,
    0.048119075621050444,    0.04421476130869618,     0.03903804225173768,     0.038690459216587474,    0.03990699283546522,
    0.04086832189508224,     0.036372520987752004,    0.042004086584227475,    27.537995086299777,      0.03344481762788201,
    0.03894266775569428,     0.03128746453757579,     0.03727947108216736,     0.03803070480155207,     0.03987954757000271,
    0.04110518062050492,     0.04126455829768306,     0.04587640568797714,     0.05143976502425725,     0.05534384055856516,
    0.07217281342612283,     0.08291871895343385,     0.08925284906619085,     23.273371496795004,      27.4893304681141,
    11.777868235603112,      9.971530707357312,       8.442225932465465,       7.147466200169872,       6.051280016815604,
    5.123212732512339,       4.337480438789674,       3.672253630517724,       3.109050730523542,       2.63222462758004,
    2.228527962575944,       1.886745085486393,       1.5973804580366546,      1.3523948451465542,      1.1449819659287483,
    0.9693793990763057,      0.8207084891431535,      0.6948388059344524,      0.588273391367592,       0.5018349787991503,
    0.25589093616637243,     0.2166456846582926,      0.18341936367196854,     0.1552888672714308,      0.13147266360367066,
    0.11130908209170755,     27.537995086299777,      27.006734889479777,      27.537995086299777,      27.537995086299777,
    27.537995086299777,      27.537995086299777,      27.006734889479777,      27.006734889479777,      28.632072948751578,
    1.836366624034242,       1.1129456446204833,      0.9369235504335415,      0.7887408909860412,      0.6627395854436663,
    0.5579215197148953,      0.4617516956753633,      0.3850618291184286,      0.32110897184073084,     0.2749650253352256,
    0.24522676272598048,     0.21714722161528313,     0.1775020266394592,      0.15023167680074148,     0.12791503461274753,
    0.10860484535652765,     0.0912305679616993,      0.07707197606217743,     0.0650403841207425,      0.05506532884429814,
    0.04641895170923259,     0.03887723298869255,     0.032790436250850166,    0.027552166212959823,    0.023238473531325,
    0.019704256561654025,    0.016531463091069995,    0.014075744333855028,    0.011710868550475645,    0.00890835126039789,
    0.007537665304471227,    0.00018360690326565005,  0.00016581026303137667,  0.000010643213107112924, 0.006378952983158241,
    0.00013737359519154873,  0.00017632661564844453,  0.0053647466382439985,   0.0045665888962924586,   0.00009896567700617791,
    0.00016648783743244456,  0.003851622931376571,    0.00016054874174147225,  0.0000708096355445176,   0.0032450851645278275,
    0.002714917305012463,    0.00015435356570592053,  0.00005042728261700056,  0.002276282379981963,    0.0019271755462497945,
    0.00004241735979918805,  0.00015043270991551034,  0.000011000602953038829, 0.001631610216168621,    0.00003583436793286507,
    0.00014730343604829998,  0.000012858854921451499, 0.0013831182751074388,   0.000030431627018175137, 0.0011642191657291261,
    0.000015303604780173518, 0.00002554715055655508,  0.00014484695046175622,  0.000976755763809023,    0.000017570086906444145,
    0.000021431213084554462, 0.0008194778528118846,   0.0006885663196361736,   0.0001432120229268507,   0.0005785678952889806,
    0.0004824766516630266,   0.00014624879013871338,  0.0004023446881436382,   0.00015888347251254452,  0.00033704834058957906,
    0.0002873063726471931,   0.00018924976289307527,  0.00023509899258932198,  0.000010852579974793191, 0.000010852579974793191,
    0.000010643213107112924, 0.000011066065381193046, 0.00008896897326554588,  0.0008359221258671176,   0.0091785685904222,
    0.15172217832162155};

void sortByNearestNeighbor(int N, double x[], double y[], double sortedX[], double sortedY[]) {
  std::vector<bool> visited(N, false);
  std::vector<double> logX(N), logY(N);

  for (int i = 0; i < N; ++i) {
    logX[i] = log(x[i]);
    logY[i] = log(y[i]);
  }

  int currentIndex = 0;
  visited[currentIndex] = true;

  sortedX[0] = x[0];
  sortedY[0] = y[0];

  for (int i = 1; i < N; ++i) {
    double nearestDist = std::numeric_limits<double>::max();
    int nearestIndex = -1;

    for (int j = 0; j < N; ++j) {
      if (!visited[j]) {
        double dx = logX[currentIndex] - logX[j];
        double dy = logY[currentIndex] - logY[j];
        double dist = sqrt(dx * dx + dy * dy);
        if (dist < nearestDist) {
          nearestDist = dist;
          nearestIndex = j;
        }
      }
    }

    if (nearestIndex != -1) {
      visited[nearestIndex] = true;
      sortedX[i] = x[nearestIndex];
      sortedY[i] = y[nearestIndex];
      currentIndex = nearestIndex;
    } else {
      std::cerr << "Error: No unvisited neighbor found. Check data integrity." << std::endl;
      break;
    }
  }
}

void set_other_graph_style(TGraph *graph) {
  auto ci_other = TColor::GetColor(color_other.c_str());
  graph->SetFillColorAlpha(ci_other, other_alpha);
  graph->SetLineWidth(other_line_width);
  graph->SetLineColor(ci_other);
}

void plot_briefing_limits() {
  gROOT->SetBatch(kTRUE);

  TCanvas *ALPs_limits_ma_gagamma = new TCanvas("ALPs_limits_ma_gagamma", "ALPs_limits_ma_gagamma", 195, 127, 1036, 759);
  gStyle->SetOptTitle(0);
  ALPs_limits_ma_gagamma->ToggleEventStatus();
  ALPs_limits_ma_gagamma->Range(-3.825111, -5.834341, 3.584386, 1.564947);
  ALPs_limits_ma_gagamma->SetFillColor(kBlack);
  ALPs_limits_ma_gagamma->SetBorderMode(0);
  ALPs_limits_ma_gagamma->SetBorderSize(0);
  ALPs_limits_ma_gagamma->SetLogx();
  ALPs_limits_ma_gagamma->SetLogy();
  ALPs_limits_ma_gagamma->SetLeftMargin(0.13);
  ALPs_limits_ma_gagamma->SetRightMargin(0.01447662);
  ALPs_limits_ma_gagamma->SetTopMargin(0.07);
  ALPs_limits_ma_gagamma->SetBottomMargin(0.13);
  ALPs_limits_ma_gagamma->SetFrameBorderMode(0);
  ALPs_limits_ma_gagamma->SetFrameBorderMode(0);
  // change color of axes, ticks, labels, etc. to kWhite
  ALPs_limits_ma_gagamma->SetFrameFillColor(kBlack);
  ALPs_limits_ma_gagamma->SetFrameLineColor(kWhite);

  TH2F *myframe__1 = new TH2F("myframe__1", "myframe", 100, 0.001, 3000, 100, 1e-05, 30);
  myframe__1->SetStats(0);
  myframe__1->GetXaxis()->SetTitle("ALP mass (GeV)");
  myframe__1->GetXaxis()->SetLabelFont(42);
  myframe__1->GetXaxis()->SetLabelSize(0.05);
  myframe__1->GetXaxis()->SetTitleSize(0.05);
  myframe__1->GetXaxis()->SetTitleOffset(1.11);
  myframe__1->GetYaxis()->SetTitle("ALP-photon coupling (TeV^{-1})");
  myframe__1->GetYaxis()->SetLabelFont(42);
  myframe__1->GetYaxis()->SetLabelSize(0.05);
  myframe__1->GetYaxis()->SetTitleSize(0.05);
  myframe__1->GetYaxis()->SetTitleOffset(1.11);
  myframe__1->GetZaxis()->SetLabelSize(0.04);
  myframe__1->GetZaxis()->SetTitleSize(0.04);
  myframe__1->GetZaxis()->SetTitleOffset(1);

  myframe__1->GetXaxis()->SetAxisColor(kWhite);
  myframe__1->GetYaxis()->SetAxisColor(kWhite);
  myframe__1->GetZaxis()->SetAxisColor(kWhite);
  myframe__1->GetXaxis()->SetLabelColor(kWhite);
  myframe__1->GetYaxis()->SetLabelColor(kWhite);
  myframe__1->GetZaxis()->SetLabelColor(kWhite);
  myframe__1->GetXaxis()->SetTitleColor(kWhite);
  myframe__1->GetYaxis()->SetTitleColor(kWhite);
  myframe__1->GetZaxis()->SetTitleColor(kWhite);

  myframe__1->Draw("");
  myframe__1->GetYaxis()->SetLimits(1e-3, 20);
  myframe__1->GetXaxis()->SetLimits(1e-1, 3e2);
  
  double other_sorted_x[nOtherPoints], other_sorted_y[nOtherPoints];
  sortByNearestNeighbor(nOtherPoints, other_x, other_y, other_sorted_x, other_sorted_y);

  vector<double> other_x_cleaned, other_y_cleaned;

  int iSkip = 245;
  int nSkip = 10;

  for (int i = 0; i < nOtherPoints; i++) {
    if (i < iSkip || i > iSkip + nSkip) {
      other_x_cleaned.push_back(other_sorted_x[i]);
      other_y_cleaned.push_back(other_sorted_y[i]);
    }
  }

  vector<double> other_x_shifted(other_x_cleaned.size());
  vector<double> other_y_shifted(other_y_cleaned.size());

  int shift = 150;

  for (int i = 0; i < other_x_cleaned.size(); i++) {
    other_x_shifted[i] = other_x_cleaned[(i + shift) % other_x_cleaned.size()];
    other_y_shifted[i] = other_y_cleaned[(i + shift) % other_y_cleaned.size()];
  }

  // shift all entries in other_x_cleaned by N indices

  auto graph_other = new TGraph(other_x_cleaned.size(), &other_x_shifted[0], &other_y_shifted[0]);
  set_other_graph_style(graph_other);
  graph_other->Draw("LF");
  
  auto myframe_copy__2 = new TH2F("myframe_copy__2", "myframe", 100, 0.001, 3000, 100, 1e-05, 30);
  myframe_copy__2->SetDirectory(nullptr);
  myframe_copy__2->SetStats(0);
  myframe_copy__2->GetXaxis()->SetTitle("m_{a} (GeV)");
  myframe_copy__2->GetXaxis()->SetLabelFont(42);
  myframe_copy__2->GetXaxis()->SetLabelSize(0.05);
  myframe_copy__2->GetXaxis()->SetTitleSize(0.05);
  myframe_copy__2->GetXaxis()->SetTitleOffset(1.11);
  myframe_copy__2->GetYaxis()->SetTitle("g_{a#gamma} (TeV^{-1})");
  myframe_copy__2->GetYaxis()->SetLabelFont(42);
  myframe_copy__2->GetYaxis()->SetLabelSize(0.05);
  myframe_copy__2->GetYaxis()->SetTitleSize(0.05);
  myframe_copy__2->GetYaxis()->SetTitleOffset(1.11);
  myframe_copy__2->GetZaxis()->SetLabelSize(0.04);
  myframe_copy__2->GetZaxis()->SetTitleSize(0.04);
  myframe_copy__2->GetZaxis()->SetTitleOffset(1);

  // set frame axes color to kWhite
  myframe_copy__2->GetXaxis()->SetAxisColor(kWhite);
  myframe_copy__2->GetYaxis()->SetAxisColor(kWhite);

  myframe_copy__2->Draw("sameaxis");

  

  ALPs_limits_ma_gagamma->Modified();
  ALPs_limits_ma_gagamma->SetSelected(ALPs_limits_ma_gagamma);

  

  for (int i = 0; i < 65; i++) {
    y_atlas_2020[i] *= 1e3;
  }
  for (int i = 0; i < 12; i++) {
    y_x_cms_expected[i] *= 1e3;
    y_cms_observed[i] *= 1e3;
  }

  auto graph_atlas_2020 = new TGraph(65, x_atlas_2020, y_atlas_2020);
  auto ci_atlas = TColor::GetColor(color_atlas.c_str());
  graph_atlas_2020->SetFillColorAlpha(ci_atlas, atlas_alpha);
  graph_atlas_2020->SetLineColor(ci_atlas);
  graph_atlas_2020->SetLineWidth(atlas_line_width);
  graph_atlas_2020->Draw("LFsame");

  auto graph_cms_observed = new TGraph(12, x_cms_observed, y_cms_observed);
  auto ci_cms = TColor::GetColor(color_cms.c_str());
  graph_cms_observed->SetLineColor(ci_cms);
  graph_cms_observed->SetFillColorAlpha(ci_cms, cms_alpha);
  graph_cms_observed->SetLineWidth(cms_line_width);
  graph_cms_observed->Draw("LFsame");

  // auto graph_cms_expected = new TGraph(12, x_cms_expected, y_x_cms_expected);
  // graph_cms_expected->SetLineColor(cms_color);
  // graph_cms_expected->SetLineWidth(5);
  // graph_cms_expected->SetLineStyle(2);
  // graph_cms_expected->Draw("Lsame");

  // Labels
  auto tex = new TLatex(0.2, 0.5, "Other experiments");
  auto ci_other = TColor::GetColor(color_other.c_str());
  tex->SetTextColor(ci_other);
  tex->SetTextSize(legend_text_size);
  tex->SetLineWidth(2);
  tex->Draw();

  tex = new TLatex(1.0, 10, "Excluded");
  tex->SetTextColor(ci_other);
  tex->SetTextSize(legend_text_size);
  tex->SetLineWidth(2);
  tex->Draw();

  tex = new TLatex(0.12, 0.95, "#bf{CMS}");
  tex->SetNDC();
  tex->SetTextFont(42);
  tex->SetTextSize(0.04);
  tex->SetLineWidth(2);
  tex->SetTextColor(kWhite);
  tex->Draw();

  tex = new TLatex(50, 0.04, "#splitline{ATLAS}{(PbPb)}");
  tex->SetTextColor(ci_atlas);
  tex->SetTextSize(legend_text_size);
  tex->SetLineWidth(2);
  tex->Draw();

  tex = new TLatex(3, 0.04, "#splitline{CMS}{(PbPb)}");
  tex->SetTextColor(ci_cms);
  tex->SetTextSize(legend_text_size);
  tex->SetLineWidth(2);
  tex->Draw();

  gStyle->SetLineScalePS(1);
  ALPs_limits_ma_gagamma->SaveAs("figures/briefing_limits.pdf");
  ALPs_limits_ma_gagamma->SaveAs("figures/briefing_limits.jpeg");
}
